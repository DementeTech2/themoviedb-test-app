"use strict";angular.module("tmdapitestApp",["ngMaterial","ngSanitize","config","angular-carousel","ngRoute"]).config(["$routeProvider",function(a){a.when("/:id/:name",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"ctrl"}).when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"ctrl"}).otherwise({redirectTo:"/"})}]),angular.module("config",[]).constant("API",{url:"http://159.203.66.105"}),angular.module("tmdapitestApp").controller("MainCtrl",["$window","$rootScope","$scope","$http","$mdDialog","$mdSidenav","$routeParams","$location","MoviesService",function(a,b,c,d,e,f,g,h,i){c.actor={selected2:void 0,selected:void 0},c.actorExtended=void 0,c.actorList=[],c.movies=[],c.loadingMovies=!1,c.loadingActor=!1,c.openSide=!1,b.$on("$routeChangeSuccess",function(b){a.ga("send","pageview",{page:h.url()})}),c.openActor=function(a){a&&setTimeout(function(){h.path("/"+a.id+"/"+a.name)},100)},c.refreshActors=function(a){return c.actorList=[],""!==a?i.searchActors(a).then(function(a){return c.loadingMovies=!1,a.data.success?c.actorList=a.data.results:c.actorList=[],c.actorList}):c.actorList},c.refreshActorInfo=function(){return c.actorExtended=void 0,c.actor.selected2?(c.loadingActor=!0,i.getActorInfo(c.actor.selected2.id).then(function(a){c.loadingActor=!1,c.actorExtended=a.data.results})):void 0},c.refreshMovies=function(){return c.movies=[],c.actor.selected2?(c.loadingMovies=!0,i.getMovies(c.actor.selected2.id).then(function(a){c.loadingMovies=!1,c.movies=a.data.results})):void 0},c.openMovie=function(a,b){e.show({controller:"MovieCtrl as ctrl",templateUrl:"views/movie.html",parent:angular.element(document.body),targetEvent:a,clickOutsideToClose:!0,locals:{movieSelected:b,actorSelected:c.actor.selected2},bindToController:!0}).then(function(a){a&&c.openActor(a)})},c.toggleActorSidebar=function(){c.openSide=!c.openSide},c.getMovieImage=function(a){return a?"http://image.tmdb.org/t/p/w185"+a:"http://dummyimage.com/185x278/555/fff.png&text=No+image"},g.id&&(c.actor.selected2={id:g.id,name:g.name},c.actor.selected=c.actor.selected2,c.refreshMovies(),c.refreshActorInfo())}]),angular.module("tmdapitestApp").service("MoviesService",["$http","API",function(a,b){function c(c){var d={actor:c},e=b.url+"/actor.php";return a.get(e,{params:d})}function d(c){var d={q:c},e=b.url+"/searchActor.php";return a.get(e,{params:d})}function e(c){var d={movie:c},e=b.url+"/movie.php";return a.get(e,{params:d})}function f(c){var d={actor:c},e=b.url+"/movies.php";return a.get(e,{params:d})}return{searchActors:d,getActorInfo:c,getMovies:f,getMovieInfo:e}}]),angular.module("tmdapitestApp").controller("MovieCtrl",["$scope","$mdDialog","$sce","MoviesService","movieSelected","actorSelected",function(a,b,c,d,e,f){a.movieSelected=e,a.movieExtended=void 0,a.movieImages=[],a.movieTrailer=void 0,a.actorSelected=f,a.exdended=!1,d.getMovieInfo(a.movieSelected.id).then(function(b){b.data.success&&(a.exdended=!0,a.movieExtended=b.data.results,a.movieImages=a.movieExtended.images.posters.concat(a.movieExtended.images.backdrops),a.hasVideo()&&(a.movieTrailer=a.movieExtended.videos.results[0]))}),a.hide=function(){b.hide(!1)},a.openActor=function(a){b.hide(a)},a.hasImages=function(){return a.movieExtended?a.movieImages.length>0:!1},a.hasVideo=function(){return a.movieExtended?a.movieExtended.videos.results.length>0:!1},a.getIframeSrc=function(a){return c.trustAsResourceUrl("https://www.youtube.com/embed/"+a)}}]);